sudo: required
services:
  - docker

env:
  - KITCHEN_LOCAL_YAML=.kitchen-docker.yml
  
before_install:
  - sudo apt-get update
  - curl -L http://bootstrap.saltstack.org | sudo sh 

install:
  - pip install PyYAML
  - pip install virtualenv
  - |
    cat <<EOF | tee  Gemfile
    source 'https://rubygems.org'
    gem 'rake'
    gem 'test-kitchen'
    gem 'kitchen-docker'
    gem 'kitchen-inspec'
    gem 'inspec'
    gem 'kitchen-salt', :git => 'https://github.com/salt-formulas/kitchen-salt.git'
    EOF
  - rm Gemfile.lock
  - bundle install

before_script:
  - set -o pipefail
  - make test | tail

script:
  -  bundle exec kitchen test 
